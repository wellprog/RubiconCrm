jQuery.Class("Vtiger_List_Js",{listInstance:false,getRelatedModulesContainer:false,massEditPreSave:"Vtiger.MassEdit.PreSave",getInstance:function(){if(Vtiger_List_Js.listInstance==false){var c=app.getModuleName();var e=app.getParentModuleName();if(e=="Settings"){var b=e+"_"+c+"_List_Js";if(typeof window[b]=="undefined"){b=c+"_List_Js"}var d=e+"_Vtiger_List_Js";if(typeof window[d]=="undefined"){d="Vtiger_List_Js"}}else{b=c+"_List_Js";d="Vtiger_List_Js"}if(typeof window[b]!="undefined"){var a=new window[b]()}else{var a=new window[d]()}Vtiger_List_Js.listInstance=a;return a}return Vtiger_List_Js.listInstance},triggerSendEmail:function(f){var d=Vtiger_List_Js.getInstance();var c=d.checkListRecordSelected();if(c!=true){var b=d.readSelectedIds(true);var e=d.readExcludedIds(true);var a=d.getDefaultParams();delete a.parent;a.module=app.getModuleName();a.view="SendMailModal";a.selected_ids=b;a.excluded_ids=e;a.cvid=d.getCurrentCvId();if(f){jQuery.extend(a,f)}AppConnector.request(a).then(function(g){app.showModalWindow(g,function(h){h.find('[name="saveButton"]').click(function(i){if(h.find("form").validationEngine("validate")){jQuery.extend(a,{field:h.find("#field").val(),template:h.find("#template").val(),action:"Mail",mode:"sendMails",});delete a.view;AppConnector.request(a).then(function(j){if(j.result==true){app.hideModalWindow()}},function(k,j){app.hideModalWindow()})}})})})}else{d.noRecordSelectedAlert()}},triggerSendSms:function(d,b){var c=Vtiger_List_Js.getInstance();var a=c.checkListRecordSelected();if(a!=true){Vtiger_List_Js.triggerMassAction(d)}else{c.noRecordSelectedAlert()}},triggerTransferOwnership:function(f){var d=this;var c=Vtiger_List_Js.getInstance();var a=c.checkListRecordSelected();if(a!=true){var e=jQuery.progressIndicator();d.getRelatedModulesContainer=false;var b={type:"POST",url:f,dataType:"html",data:{}};AppConnector.request(b).then(function(g){e.progressIndicator({mode:"hide"});if(g){var h=function(i){var j=app.validationEngineOptions;j.onValidationComplete=function(l,k){if(k){d.transferOwnershipSave(l)}return false};jQuery("#changeOwner").validationEngine(app.validationEngineOptions)};app.showModalWindow(g,function(j){var i=d.getRelatedModuleContainer();app.changeSelectElementView(i,"select2");if(typeof h=="function"){h(j)}})}})}else{c.noRecordSelectedAlert()}},triggerQuickExportToExcel:function(g){var j="index.php";var m=this;var b=Vtiger_List_Js.getInstance();var f=b.checkListRecordSelected();if(f!=true){var i=jQuery.progressIndicator();var k=b.readSelectedIds(true);var l=b.readExcludedIds(true);var c=b.getCurrentCvId();var e={viewname:c,selected_ids:k,excluded_ids:l};var a=b.getListSearchInstance().getAlphabetSearchValue();e.search_params=JSON.stringify(b.getListSearchInstance().getListSearchParams());if((typeof a!="undefined")&&(a.length>0)){e.search_key=b.getListSearchInstance().getAlphabetSearchField();e.search_value=a;e.operator="s"}var h={type:"POST",url:j,dataType:"application/x-msexcel",data:e};var d=$('<form method="POST" action="'+j+'">');d.append($("<input />",{name:"module",value:g}));d.append($("<input />",{name:"action",value:"QuickExport"}));d.append($("<input />",{name:"mode",value:"exportToExcel"}));if(typeof csrfMagicName!=="undefined"){d.append($("<input />",{name:csrfMagicName,value:csrfMagicToken}))}$.each(h.data,function(o,n){d.append($("<input />",{name:o,value:n}))});$("body").append(d);d.submit();Vtiger_Helper_Js.showMessage({text:app.vtranslate("JS_STARTED_GENERATING_FILE"),type:"info"});i.progressIndicator({mode:"hide"})}else{b.noRecordSelectedAlert()}},transferOwnershipSave:function(d){var c=Vtiger_List_Js.getInstance();var b=c.readSelectedIds(true);var f=c.readExcludedIds(true);var a=c.getCurrentCvId();var h=jQuery("#transferOwnerId").val();var e=jQuery("#related_modules").val();var g={module:app.getModuleName(),action:"TransferOwnership",viewname:a,selected_ids:b,excluded_ids:f,transferOwnerId:h,related_modules:e};AppConnector.request(g).then(function(i){if(i.success){app.hideModalWindow();var j={title:app.vtranslate("JS_MESSAGE"),text:app.vtranslate("JS_RECORDS_TRANSFERRED_SUCCESSFULLY"),animation:"show",type:"info"};Vtiger_Helper_Js.showPnotify(j);c.getListViewRecords();Vtiger_List_Js.clearList()}})},getRelatedModuleContainer:function(){if(this.getRelatedModulesContainer==false){this.getRelatedModulesContainer=jQuery("#related_modules")}return this.getRelatedModulesContainer},triggerMassAction:function(l,g,j,k){if(typeof j=="undefined"){j=function(){return true}}if(typeof j=="object"){k=j;j=function(){return true}}var b=Vtiger_List_Js.getInstance();var e=b.checkListRecordSelected();if(e!=true){var i=jQuery.progressIndicator();var m=b.readSelectedIds(true);var n=b.readExcludedIds(true);var c=b.getCurrentCvId();var d={viewname:c,selected_ids:m,excluded_ids:n};var h=Vtiger_List_Js.getInstance();if(h.getListSearchInstance()){var a=h.getListSearchInstance().getAlphabetSearchValue();d.search_params=JSON.stringify(h.getListSearchInstance().getListSearchParams());if((typeof a!="undefined")&&(a.length>0)){d.search_key=h.getListSearchInstance().getAlphabetSearchField();d.search_value=a;d.operator="s"}}var f={type:"POST",url:l,dataType:"html",data:d};if(typeof k=="undefined"){k={}}var k=jQuery.extend({"text-align":"left"},k);AppConnector.request(f).then(function(p){i.progressIndicator({mode:"hide"});if(p){var o=j(p);if(!o){return}app.showModalWindow(p,function(q){if(typeof g=="function"){g(q)}},k)}},function(o,p){i.progressIndicator({mode:"hide"});Vtiger_Helper_Js.showPnotify({title:app.vtranslate("JS_MESSAGE"),text:p,animation:"show",type:"error"})})}else{b.noRecordSelectedAlert()}},triggerMassEdit:function(b){var a=this.getSelectedRecordCount();if(a>jQuery("#listMaxEntriesMassEdit").val()){var c={title:app.vtranslate("JS_MESSAGE"),text:app.vtranslate("JS_MASS_EDIT_LIMIT"),animation:"show",type:"error"};Vtiger_Helper_Js.showPnotify(c);return}Vtiger_List_Js.triggerMassAction(b,function(e){var d=e.find("#massEdit");d.validationEngine(app.validationEngineOptions);var f=Vtiger_List_Js.getInstance();f.inactiveFieldsValidation(d);f.registerEventForTabClick(d);var g=Vtiger_Edit_Js.getInstance();g.registerBasicEvents(d);f.postMassEdit(e);f.registerSlimScrollMassEdit()},{width:"65%"})},getSelectedRecordCount:function(){var e;var d=Vtiger_List_Js.getInstance();var b=d.getCurrentCvId();var a=jQuery("#selectedIds").data(b+"Selectedids");if(a!=undefined){if(a!="all"){e=a.length}else{var c=jQuery("#excludedIds").data(b+"Excludedids").length;var f=jQuery("#recordsCount").val();e=f-c}}return e},triggerExportAction:function(f){var e=Vtiger_List_Js.getInstance();var c=e.readSelectedIds(true);var h=e.readExcludedIds(true);var b=e.getCurrentCvId();var a=jQuery("#pageNumber").val();if("undefined"===typeof b){f+="&selected_ids="+c+"&excluded_ids="+h+"&page="+a}else{f+="&selected_ids="+c+"&excluded_ids="+h+"&viewname="+b+"&page="+a}var d=Vtiger_List_Js.getInstance();if(d.getListSearchInstance()){var g=d.getListSearchInstance().getAlphabetSearchValue();f+="&search_params="+JSON.stringify(d.getListSearchInstance().getListSearchParams());if((typeof g!="undefined")&&(g.length>0)){f+="&search_key="+d.getListSearchInstance().getAlphabetSearchField();f+="&search_value="+g;f+="&operator=s"}}window.location.href=f},clearList:function(){jQuery("#deSelectAllMsg").trigger("click");jQuery("#selectAllMsgDiv").hide()},showDuplicateSearchForm:function(a){var b=jQuery.progressIndicator();app.showModalWindow("",a,function(){b.progressIndicator({mode:"hide"});Vtiger_List_Js.registerDuplicateSearchButtonEvent()})},registerDuplicateSearchButtonEvent:function(){jQuery("#fieldList").on("change",function(c){var b=jQuery(c.currentTarget).val();var a=jQuery("#findDuplicate").find('button[type="submit"]');if(b!=null){a.attr("disabled",false)}else{a.attr("disabled",true)}})},triggerListSearch:function(){var a=Vtiger_List_Js.getInstance();var b=a.getListViewContentContainer();b.find('[data-trigger="listSearch"]').trigger("click")},getSelectedRecordsParams:function(d,h){var e=Vtiger_List_Js.getInstance();if(d==false||e.checkListRecordSelected()!=true){var c=e.readSelectedIds(true);var g=e.readExcludedIds(true);var b=e.getCurrentCvId();var a={viewname:b,selected_ids:c,excluded_ids:g};var f=e.getListSearchInstance().getAlphabetSearchValue();a.search_params=JSON.stringify(e.getListSearchInstance().getListSearchParams());if((typeof f!="undefined")&&(f.length>0)){a.search_key=e.getListSearchInstance().getAlphabetSearchField();a.search_value=f;a.operator="s"}return a}else{e.noRecordSelectedAlert()}return false},triggerGenerateRecords:function(a){var b=Vtiger_List_Js.getSelectedRecordsParams();if(b===false){return false}var d={};jQuery.extend(d,b);a+="&"+jQuery.param(d);var c=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});app.showModalWindow(null,a,function(){c.progressIndicator({mode:"hide"})})},showMap:function(){var b=Vtiger_List_Js.getSelectedRecordsParams(false);var a="index.php?module=OpenStreetMap&view=MapModal&srcModule="+app.getModuleName();app.showModalWindow(null,a,function(c){var d=new OpenStreetMap_Map_Js();d.setSelectedParams(b);d.registerModalView(c)})},triggerReviewChanges:function(a){var f=Vtiger_List_Js.getInstance();var d=f.checkListRecordSelected();if(d!=true){var c=f.readSelectedIds(true);var g=f.readExcludedIds(true);var b=f.getCurrentCvId();var e=app.vtranslate("JS_MASS_REVIEWING_CHANGES_CONFIRMATION");Vtiger_Helper_Js.showConfirmationBox({message:e}).then(function(k){var h=a+"&viewname="+b+"&selected_ids="+c+"&excluded_ids="+g;if(f.getListSearchInstance()){var i=f.getListSearchInstance().getAlphabetSearchValue();h+="&search_params="+JSON.stringify(f.getListSearchInstance().getListSearchParams());if((typeof i!="undefined")&&(i.length>0)){h+="&search_key="+f.getListSearchInstance().getAlphabetSearchField();h+="&search_value="+i;h+="&operator=s"}}var l=app.vtranslate("JS_LOADING_PLEASE_WAIT");var j=jQuery.progressIndicator({message:l,position:"html",blockInfo:{enabled:true}});AppConnector.request(h).then(function(m){j.progressIndicator({mode:"hide"});if(m.result){var n={text:m.result,type:"info"};Vtiger_Helper_Js.showPnotify(n)}else{f.getListViewRecords()}},function(m,n){app.errorLog(m,n)})},function(h,i){Vtiger_List_Js.clearList()})}else{f.noRecordSelectedAlert()}}},{listViewContainer:false,listViewTopMenuContainer:false,listViewContentContainer:false,filterBlock:false,filterSelectElement:false,listSearchInstance:false,noEventsListSearch:true,getListSearchInstance:function(a){if(a!=undefined){this.noEventsListSearch=a}if(this.listSearchInstance==false&&(this.getListViewContainer().find(".searchField").length||this.getListViewContainer().find(".picklistSearchField").length)){this.listSearchInstance=YetiForce_ListSearch_Js.getInstance(this.getListViewContainer(),this.noEventsListSearch)}return this.listSearchInstance},getListViewContainer:function(){if(this.listViewContainer==false){this.listViewContainer=jQuery("div.listViewPageDiv")}return this.listViewContainer},getListViewTopMenuContainer:function(){if(this.listViewTopMenuContainer==false){this.listViewTopMenuContainer=jQuery(".listViewTopMenuDiv")}return this.listViewTopMenuContainer},getListViewContentContainer:function(){if(this.listViewContentContainer==false){this.listViewContentContainer=jQuery(".listViewContentDiv")}return this.listViewContentContainer},getFilterBlock:function(){if(this.filterBlock==false){var a=this.getFilterSelectElement();if(a.length<=0){this.filterBlock=jQuery()}else{if(a.is("select")){this.filterBlock=a.data("select2").$dropdown}}}return this.filterBlock},getFilterSelectElement:function(){if(this.filterSelectElement==false){this.filterSelectElement=jQuery("#customFilter")}return this.filterSelectElement},getDefaultParams:function(){var c={module:app.getModuleName(),page:jQuery("#pageNumber").val(),view:app.getViewName(),viewname:this.getCurrentCvId(),orderby:jQuery("#orderBy").val(),sortorder:jQuery("#sortOrder").val(),entityState:jQuery("#entityState").val(),};if(app.getParentModuleName()){c.parent=app.getParentModuleName()}var a=this.getListSearchInstance();if(a!==false){var b=this.getListSearchInstance().getAlphabetSearchValue();c.search_params=JSON.stringify(this.getListSearchInstance().getListSearchParams(true));if((typeof b!="undefined")&&(b.length>0)){c.search_key=this.getListSearchInstance().getAlphabetSearchField();c.search_value=b;c.operator="s"}}return c},getListViewRecords:function(b){var a=$.Deferred();if(typeof b=="undefined"){b={}}var d=this;var g=$("#listViewContents");var e=jQuery(".listViewLoadingMsg").text();var f=$.progressIndicator({message:e,position:"html",blockInfo:{enabled:true}});var c=this.getDefaultParams();var b=$.extend(c,b);AppConnector.requestPjax(b).then(function(h){f.progressIndicator({mode:"hide"});g.html(h);app.event.trigger("RecordListView.AfterLoad",h,d);d.calculatePages().then(function(i){a.resolve(i);app.notifyPostAjaxReady()});d.postLoadListViewRecordsEvents(g)},function(i,h){a.reject(i,h)});return a.promise()},postLoadListViewRecordsEvents:function(a){var c=this;app.showSelect2ElementView(a.find("select.select2"));app.changeSelectElementView(a);app.showPopoverElementView(a.find(".popoverTooltip"));c.registerListViewSpecialOptiopn();var e=c.getListSearchInstance();if(e!==false){e.registerBasicEvents()}Vtiger_Index_Js.registerMailButtons(a);Vtiger_Helper_Js.showHorizontalTopScrollBar();var b=c.readSelectedIds();if(b!=""){if(b=="all"){$(".listViewEntriesCheckBox").each(function(f,g){$(this).prop("checked",true).closest("tr").addClass("highlightBackgroundColor")});$("#deSelectAllMsgDiv").show();var d=c.readExcludedIds();if(d!=""){$("#listViewEntriesMainCheckBox").prop("checked",false);$(".listViewEntriesCheckBox").each(function(f,g){if($.inArray($(g).val(),d)!=-1){$(g).prop("checked",false).closest("tr").removeClass("highlightBackgroundColor")}})}}else{$(".listViewEntriesCheckBox").each(function(f,g){if($.inArray($(g).val(),b)!=-1){$(this).prop("checked",true).closest("tr").addClass("highlightBackgroundColor")}})}c.checkSelectAll()}c.registerUnreviewedCountEvent();c.registerLastRelationsEvent()},calculatePages:function(){var b=jQuery.Deferred();var c=jQuery("#totalPageCount");var a=c.text();if(a==""){var d=jQuery("#totalCount").val();if(d!=""){var e=jQuery("#pageLimit").val();if(e=="0"){e=1}pageCount=Math.ceil(d/e);if(pageCount==0){pageCount=1}c.text(pageCount);b.resolve();return b.promise()}b.resolve()}else{b.resolve()}return b.promise()},noRecordSelectedAlert:function(){return alert(app.vtranslate("JS_PLEASE_SELECT_ONE_RECORD"))},massActionSave:function(b,c){if(typeof c=="undefined"){c=false}var a=jQuery.Deferred();if(c){var f=jQuery.Event(Vtiger_List_Js.massEditPreSave);b.trigger(f);if(f.isDefaultPrevented()){b.find('[name="saveButton"]').removeAttr("disabled");a.reject();return a.promise()}b.find('[id^="selectRow"]').each(function(g,h){h=jQuery(h);if(!h.prop("checked")){h.closest(".rowElements").find(".fieldValue [name]").each(function(i,j){j=jQuery(j);j.attr("data-element-name",j.attr("name")).removeAttr("name")})}})}var e=b.serializeFormData();var d=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});AppConnector.request(e).then(function(g){d.progressIndicator({mode:"hide"});app.hideModalWindow();if(!(g.result)){var h={text:app.vtranslate("JS_MASS_EDIT_NOT_SUCCESSFUL"),type:"info"};Vtiger_Helper_Js.showPnotify(h)}a.resolve(g)},function(g,h){app.hideModalWindow();app.errorLog(g,h);a.reject(g,h)});return a.promise()},checkSelectAll:function(){var a=true;jQuery(".listViewEntriesCheckBox").each(function(b,c){if(jQuery(c).is(":checked")){a=true}else{a=false;return false}});if(a==true){jQuery("#listViewEntriesMainCheckBox").prop("checked",true)}else{jQuery("#listViewEntriesMainCheckBox").prop("checked",false)}},getRecordsCount:function(){var a=jQuery.Deferred();var b=jQuery("#recordsCount").val();if(b!=""){a.resolve(b)}else{var c="";var d=this.getDefaultParams();d.view="ListAjax";d.mode="getRecordsCount";AppConnector.request(d).then(function(f){var e=JSON.parse(f);jQuery("#recordsCount").val(e.result["count"]);c=e.result["count"];a.resolve(c)})}return a.promise()},getSelectOptionFromChosenOption:function(c){var d=c.attr("id");var b=d.split("-");var a="";if(b.length>0){a=b[b.length-1]}else{return false}return jQuery("#filterOptionId_"+a)},readSelectedIds:function(e){var b=this.getCurrentCvId();var f=jQuery("#selectedIds");var c=b+"Selectedids";var d=f.data();if(!(c in d)){var a=[];this.writeSelectedIds(a)}else{a=d[c]}if(e==true){if(typeof a=="object"){return JSON.stringify(a)}}return a},readExcludedIds:function(e){var a=this.getCurrentCvId();var d=jQuery("#excludedIds");var b=a+"Excludedids";var f=d.data();if(!(b in f)){var c=[];this.writeExcludedIds(c)}else{c=f[b]}if(e==true){if(typeof c=="object"){return JSON.stringify(c)}}return c},writeSelectedIds:function(b){var a=this.getCurrentCvId();jQuery("#selectedIds").data(a+"Selectedids",b)},writeExcludedIds:function(b){var a=this.getCurrentCvId();jQuery("#excludedIds").data(a+"Excludedids",b)},getCurrentCvId:function(){return jQuery("#customFilter").find("option:selected").data("id")},getAlphabetSearchField:function(){return jQuery("#alphabetSearchKey").val()},getAlphabetSearchValue:function(){return jQuery("#alphabetValue").val()},checkListRecordSelected:function(){var a=this.readSelectedIds();if(typeof a=="object"&&a.length<=0){return true}return false},inactiveFieldValidation:function(g){g.validationEngine("hide");var e=g.closest("form");var d=e.data("jqv").InvalidFields;var a=[g.get(0)];var h=g.attr("data-validation-engine");g.attr("data-invalid-validation-engine",h?h:"validate[]");g.removeAttr("data-validation-engine");if(g.is("select")&&g.hasClass("chzn-select")){var f=app.getChosenElementFromSelect(g);f.validationEngine("hide");a.push(f.get(0))}for(var c in a){var b=jQuery.inArray(a[c],d);if(b!="-1"){d.splice(b,1)}}},activeFieldValidation:function(a){var b=a.attr("data-invalid-validation-engine");a.attr("data-validation-engine",b?b:"validate[]");a.removeAttr("data-invalid-validation-engine")},postMassEdit:function(a){var b=this;var c=Vtiger_Edit_Js.getInstance();a.find(".selectRow").on("change",function(i){var f=jQuery(i.currentTarget);var j=f.closest(".rowElements").find(".fieldValue");var g=j.find("[data-validation-engine],[data-invalid-validation-engine]");var d=g.data("fieldinfo");if(f.prop("checked")){b.activeFieldValidation(g)}else{b.inactiveFieldValidation(g)}if(d!==undefined&&d.type==="reference"){var h=c.getMappingRelatedField(d.name,c.getReferencedModuleName(j),a);$.each(h,function(e,k){var l=a.find('[id="selectRow'+e+'"]');if(l.length&&l.prop("disabled")){l.prop("disabled",false);l.trigger("click");l.prop("disabled",true)}})}});a.find("form").on("submit",function(g){g.preventDefault();var f=jQuery(g.currentTarget);if(!f.find('input[id^="selectRow"]:checked').length){Vtiger_Helper_Js.showPnotify(app.vtranslate("NONE_OF_THE_FIELD_VALUES_ARE_CHANGED_IN_MASS_EDIT"));return}var d=f.data("jqv").InvalidFields;if(d.length==0){f.find('[name="saveButton"]').prop("disabled",true)}else{return}b.massActionSave(f,true).then(function(e){b.getListViewRecords();Vtiger_List_Js.clearList()},function(e,h){app.errorLog(e,h)})})},registerPageNavigationEvents:function(){var a=jQuery.Deferred();var b=this;jQuery("#listViewNextPageButton").on("click",function(i){if($(this).hasClass("disabled")){return}var c=jQuery("#pageLimit").val();var l=jQuery("#noOfEntries").val();if(l==c){var j=jQuery("#orderBy").val();var f=jQuery("#sortOrder").val();var d=b.getCurrentCvId();var g={orderby:j,sortorder:f,viewname:d};var k=jQuery("#pageNumber").val();var h=parseInt(parseFloat(k))+1;jQuery("#pageNumber").val(h);jQuery("#pageToJump").val(h);b.getListViewRecords(g).then(function(e){b.updatePagination(h);a.resolve()},function(m,e){a.reject(m,e)})}return a.promise()});jQuery("#listViewPreviousPageButton").on("click",function(){var f=jQuery.Deferred();var c=jQuery("#pageNumber").val();if(c>1){var i=jQuery("#orderBy").val();var g=jQuery("#sortOrder").val();var e=b.getCurrentCvId();var d={orderby:i,sortorder:g,viewname:e};var h=parseInt(parseFloat(c))-1;jQuery("#pageNumber").val(h);jQuery("#pageToJump").val(h);b.getListViewRecords(d).then(function(j){b.updatePagination(h);f.resolve()},function(k,j){f.reject(k,j)})}});jQuery(".pageNumber").on("click",function(){var g=$(this).hasClass("disabled");if(g){return false}var c=$(this).data("id");var i=jQuery("#orderBy").val();var f=jQuery("#sortOrder").val();var e=b.getCurrentCvId();var d={orderby:i,sortorder:f,viewname:e,page:c};var h=parseInt(parseFloat(c))-1;jQuery("#pageNumber").val(h);jQuery("#pageToJump").val(h);b.getListViewRecords(d).then(function(j){b.updatePagination(c)},function(k,j){})});$("#totalCountBtn").on("click",function(){app.hidePopover(jQuery(this));var c={title:app.vtranslate("JS_LBL_PERMISSION"),text:app.vtranslate("JS_GET_PAGINATION_INFO"),type:"info",animation:"show"};Vtiger_Helper_Js.showMessage(c);var d=b.getDefaultParams();d.totalCount=-1;d.view="Pagination";d.mode="getPagination";AppConnector.request(d).then(function(e){jQuery(".paginationDiv").html(e);b.registerPageNavigationEvents()})});jQuery("#listViewPageJump").on("click",function(j){if(typeof Vtiger_WholeNumberGreaterThanZero_Validator_Js.invokeValidation(jQuery("#pageToJump"))!="undefined"){var d=jQuery("#pageNumber").val();jQuery("#pageToJump").val(d)}jQuery("#pageToJump").validationEngine("hideAll");var g=jQuery("#totalPageCount");var c=g.text();if(c==""){var h=jQuery("#totalCount");var i=h.val();if(i!=""){var f=jQuery("#pageLimit").val();if(f=="0"){f=1}pageCount=Math.ceil(i/f);if(pageCount==0){pageCount=1}g.text(pageCount);return}g.progressIndicator({});b.getPageCount().then(function(k){var e=k.result["page"];h.val(k.result["numberOfRecords"]);if(e==0){e=1}g.text(e);g.progressIndicator({mode:"hide"})})}});jQuery("#listViewPageJumpDropDown").on("click","li",function(c){c.stopImmediatePropagation()}).on("keypress","#pageToJump",function(k){if(k.which==13){k.stopImmediatePropagation();var h=jQuery(k.currentTarget);var g=Vtiger_WholeNumberGreaterThanZero_Validator_Js.invokeValidation(h);if(typeof g!="undefined"){h.validationEngine("showPrompt",g,"","topLeft",true)}else{h.validationEngine("hideAll");var f=jQuery("#pageNumber");var c=f.val();var i=parseInt(jQuery(k.currentTarget).val());var j=parseInt(jQuery("#totalPageCount").text());if(i>j){var l=app.vtranslate("JS_PAGE_NOT_EXIST");h.validationEngine("showPrompt",l,"","topLeft",true);return}if(i==c){var m=app.vtranslate("JS_YOU_ARE_IN_PAGE_NUMBER")+" "+i;var d={text:m,type:"info"};Vtiger_Helper_Js.showMessage(d);return}f.val(i);b.getListViewRecords().then(function(e){b.updatePagination(i);h.closest(".btn-group ").removeClass("open")},function(n,e){})}return false}})},getPageCount:function(){var b=jQuery.Deferred();var a=this.getPageJumpParams();AppConnector.request(a).then(function(d){var c;if(typeof d!="object"){c=JSON.parse(d)}else{c=d}b.resolve(c)},function(c,d){});return b.promise()},getPageJumpParams:function(){var a=this.getDefaultParams();a.view="ListAjax";a.mode="getPageCount";return a},updatePagination:function(a){a=typeof a!=="undefined"?a:1;var c=this;var b=c.getCurrentCvId();var f={};f.module=app.getModuleName();if("Settings"==app.getParentModuleName()){f.parent="Settings"}f.view="Pagination";f.viewname=b;f.page=a;f.mode="getPagination";f.sourceModule=jQuery("#moduleFilter").val();f.totalCount=$(".pagination").data("totalCount");var e=this.getListSearchInstance();if(e!==false){var d=e.getAlphabetSearchValue();f.search_params=JSON.stringify(this.getListSearchInstance().getListSearchParams());if((typeof d!="undefined")&&(d.length>0)){f.search_key=this.getListSearchInstance().getAlphabetSearchField();f.search_value=d;f.operator="s"}}f.noOfEntries=jQuery("#noOfEntries").val();AppConnector.request(f).then(function(g){jQuery(".paginationDiv").html(g);c.registerPageNavigationEvents()})},registerChangeCustomFilterEvent:function(){var a=this;this.getFilterSelectElement().on("change",function(d){var e=jQuery(d.currentTarget);var b=e.find(":selected");app.setMainParams("pageNumber","1");app.setMainParams("pageToJump","1");app.setMainParams("orderBy",b.data("orderby"));app.setMainParams("sortOrder",b.data("sortorder"));var c={viewname:jQuery(this).val(),search_key:a.getAlphabetSearchField(),search_value:"",search_params:""};jQuery("#recordsCount").val("");jQuery("#totalPageCount").text("");$(".pagination").data("totalCount",0);a.getListViewRecords(c).then(function(){a.breadCrumbsFilter(b.text());a.ListViewPostOperation();a.updatePagination(1)});d.stopPropagation()})},breadCrumbsFilter:function(d){var a=jQuery(".breadcrumbsContainer .breadcrumbsLinks");var b=a.last("span");var c=b.find(".breadCrumbsFilter");if(c.length&&d!=undefined){c.text(" ["+app.vtranslate("JS_FILTER")+": "+d+"]")}else{if(c.length<1){d=(d==undefined)?this.getFilterSelectElement().find(":selected").text():d;if(b.hasClass("breadCrumbsFilter")){b.text(": "+d)}else{a.append('<span class="font-small breadCrumbsFilter hideToHistory"> ['+app.vtranslate("JS_FILTER")+": "+d+"]</span>")}}}},ListViewPostOperation:function(){return true},registerMainCheckBoxClickEvent:function(){var a=this.getListViewContainer();var b=this;a.on("click","#listViewEntriesMainCheckBox",function(){var c=b.readSelectedIds();var e=b.readExcludedIds();if(jQuery("#listViewEntriesMainCheckBox").is(":checked")){var d=b.getRecordsCount();d.then(function(f){jQuery("#totalRecordsCount").text(f);if(jQuery("#deSelectAllMsgDiv").css("display")=="none"){jQuery("#selectAllMsgDiv").show()}});jQuery(".listViewEntriesCheckBox").each(function(f,g){jQuery(this).prop("checked",true).closest("tr").addClass("highlightBackgroundColor");if(c=="all"){if((jQuery.inArray(jQuery(g).val(),e))!=-1){e.splice(jQuery.inArray(jQuery(g).val(),e),1)}}else{if((jQuery.inArray(jQuery(g).val(),c))==-1){c.push(jQuery(g).val())}}})}else{jQuery("#selectAllMsgDiv").hide();jQuery(".listViewEntriesCheckBox").each(function(f,g){jQuery(this).prop("checked",false).closest("tr").removeClass("highlightBackgroundColor");if(c=="all"){e.push(jQuery(g).val());c="all"}else{c.splice(jQuery.inArray(jQuery(g).val(),c),1)}})}b.writeSelectedIds(c);b.writeExcludedIds(e)})},registerCheckBoxClickEvent:function(){var a=this.getListViewContainer();var b=this;a.delegate(".listViewEntriesCheckBox","click",function(g){var c=b.readSelectedIds();var f=b.readExcludedIds();var d=jQuery(g.currentTarget);if(d.is(":checked")){d.closest("tr").addClass("highlightBackgroundColor");if(c=="all"){f.splice(jQuery.inArray(d.val(),f),1)}else{if((jQuery.inArray(d.val(),c))==-1){c.push(d.val())}}}else{d.closest("tr").removeClass("highlightBackgroundColor");if(c=="all"){f.push(d.val());c="all"}else{c.splice(jQuery.inArray(d.val(),c),1)}}b.checkSelectAll();b.writeSelectedIds(c);b.writeExcludedIds(f)})},registerSelectAllClickEvent:function(){var a=this.getListViewContainer();var b=this;a.delegate("#selectAllMsg","click",function(){jQuery("#selectAllMsgDiv").hide();jQuery("#deSelectAllMsgDiv").show();jQuery("#listViewEntriesMainCheckBox").prop("checked",true);jQuery(".listViewEntriesCheckBox").each(function(c,d){jQuery(this).prop("checked",true).closest("tr").addClass("highlightBackgroundColor")});b.writeSelectedIds("all")})},registerDeselectAllClickEvent:function(){var a=this.getListViewContainer();var b=this;a.delegate("#deSelectAllMsg","click",function(){jQuery("#deSelectAllMsgDiv").hide();jQuery("#listViewEntriesMainCheckBox").prop("checked",false);jQuery(".listViewEntriesCheckBox").each(function(e,f){jQuery(this).prop("checked",false).closest("tr").removeClass("highlightBackgroundColor")});var d=[];var c=[];b.writeSelectedIds(c);b.writeExcludedIds(d)})},registerHeadersClickEvent:function(){var a=this.getListViewContainer();var b=this;a.on("click",".listViewHeaderValues",function(g){var h=jQuery(g.currentTarget).data("columnname");var c=jQuery(g.currentTarget).data("nextsortorderval");if(typeof c==="undefined"){return}var f=b.getCurrentCvId();var d={orderby:h,sortorder:c,viewname:f};b.getListViewRecords(d)})},registerCreateFilterClickEvent:function(c){var b=this;b.getFilterSelectElement().data("select2").close();var a=jQuery(c.currentTarget);var d=a.find("#createFilter");var e=d.data("createurl");Vtiger_CustomView_Js.loadFilterView(e)},registerDuplicateFilterClickEvent:function(){var a=this;var b=this.getFilterBlock();if(b!=false){b.on("mouseup","li span.duplicateFilter",function(d){a.getFilterSelectElement().data("select2").close();var f=jQuery(d.currentTarget).closest(".select2-results__option");var c=a.getSelectOptionFromChosenOption(f);var e=c.data("duplicateurl");Vtiger_CustomView_Js.loadFilterView(e);d.stopPropagation()})}},registerEditFilterClickEvent:function(){var a=this;var b=this.getFilterBlock();if(b!=false){b.on("mouseup","li span.editFilter",function(d){a.getFilterSelectElement().data("select2").close();var f=jQuery(d.currentTarget).closest(".select2-results__option");var c=a.getSelectOptionFromChosenOption(f);var e=c.data("editurl");Vtiger_CustomView_Js.loadFilterView(e);d.stopPropagation()})}},registerDeleteFilterClickEvent:function(){var a=this;var b=this.getFilterBlock();if(b!=false){b.on("mouseup","li span.deleteFilter",function(d){a.getFilterSelectElement().data("select2").close();var e=jQuery(d.currentTarget).closest(".select2-results__option");var c=app.vtranslate("JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_DELETE_FILTER");Vtiger_Helper_Js.showConfirmationBox({message:c}).then(function(j){var g=a.getSelectOptionFromChosenOption(e);var i=g.data("deleteurl");var f="<form action="+i+' method="POST">';if(typeof csrfMagicName!=="undefined"){f+='<input type = "hidden" name ="'+csrfMagicName+"\"  value='"+csrfMagicToken+"'>"}f+="</form>";var h=jQuery(f);h.appendTo("body").submit()},function(f,g){});d.stopPropagation()})}},registerApproveFilterClickEvent:function(){var a=this;var b=this.getFilterBlock();if(b!=false){b.on("mouseup","li span.approveFilter",function(g){a.getFilterSelectElement().data("select2").close();var h=jQuery(g.currentTarget).closest(".select2-results__option");var d=a.getSelectOptionFromChosenOption(h);var f=d.data("approveurl");var c="<form action="+f+' method="POST">';if(typeof csrfMagicName!=="undefined"){c+='<input type = "hidden" name ="'+csrfMagicName+"\"  value='"+csrfMagicToken+"'>"}c+="</form>";var e=jQuery(c);e.appendTo("body").submit();g.stopPropagation()})}},registerDenyFilterClickEvent:function(){var a=this;var b=this.getFilterBlock();if(b!=false){b.on("mouseup","li span.denyFilter",function(f){a.getFilterSelectElement().data("select2").close();var g=jQuery(f.currentTarget).closest(".select2-results__option");var c=a.getSelectOptionFromChosenOption(g);var e=c.data("denyurl");var d="<form action="+e+' method="POST">';if(typeof csrfMagicName!=="undefined"){d+='<input type = "hidden" name ="'+csrfMagicName+"\"  value='"+csrfMagicToken+"'>"}d+="</form>";jQuery(d).appendTo("body").submit();f.stopPropagation()})}},registerCustomFilterOptionsHoverEvent:function(){var b=this;var c=this.getListViewTopMenuContainer();var a=this.getFilterBlock();if(a!=false){a.on("hover",'li.select2-results__option[role="treeitem"]',function(e){var f=jQuery(e.currentTarget);var d=f.find(".filterActionImgs");if(f.hasClass("group-result")){return}if(e.type==="mouseenter"){if(d.length>0){d.show()}else{b.performFilterImageActions(f)}}else{d.hide()}})}},performFilterImageActions:function(f){jQuery(".filterActionImages").clone(true,true).removeClass("filterActionImages").addClass("filterActionImgs").appendTo(f).removeClass("hide");var a=this.getSelectOptionFromChosenOption(f);var c=a.data("deletable");if(c!="1"){f.find(".deleteFilter").remove()}var b=a.data("editable");if(b!="1"){f.find(".editFilter").remove()}var e=a.data("pending");if(e!="1"){f.find(".approveFilter").remove()}var d=a.data("public");if(d!="1"){f.find(".denyFilter").remove()}if($("#createFilter").length==0){f.find(".duplicateFilter").remove()}},registerRowClickEvent:function(){var b=this;var a=this.getListViewContentContainer();a.on("click",".listViewEntries",function(d){if(jQuery(d.target).closest("div").hasClass("actions")){return}if(jQuery(d.target).is("button")||jQuery(d.target).parent().is("button")){return}if(jQuery(d.target).closest("a").hasClass("noLinkBtn")){return}if(jQuery(d.target,jQuery(d.currentTarget)).is("td:first-child")){return}if(jQuery(d.target).is('input[type="checkbox"]')){return}if($.contains(jQuery(d.currentTarget).find("td:last-child").get(0),d.target)){return}if($.contains(jQuery(d.currentTarget).find("td:first-child").get(0),d.target)){return}var c=jQuery(d.currentTarget);var f=c.data("recordurl");if(typeof f=="undefined"){return}window.location.href=f})},registerRecordEvents:function(){var b=this;var a=this.getListViewContentContainer();a.on("click",".recordEvent",function(d){var e=$(this);var c=e.closest("tr").data("id");var f={};if(e.data("confirm")){f.message=e.data("confirm");f.title=e.html()+" "+e.data("content")}else{f.message=e.data("content")}Vtiger_Helper_Js.showConfirmationBox(f).then(function(h){var g=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});AppConnector.request(e.data("url")+"&sourceView=List&record="+c).then(function(n){g.progressIndicator({mode:"hide"});if(n&&n.success){if(n.result.notify){Vtiger_Helper_Js.showMessage(n.result.notify)}var l=$(".pagination");var j=l.data("totalCount");if(j!=""){j--;l.data("totalCount",j)}var o=jQuery("#orderBy").val();var m=jQuery("#sortOrder").val();var i=parseInt($("#pageNumber").val());if($("#noOfEntries").val()==1&&i!=1){i--}var k={viewname:n.result.viewname,orderby:o,sortorder:m,page:i,};$("#recordsCount").val("");$("#totalPageCount").text("");b.getListViewRecords(k).then(function(){b.updatePagination(i)})}else{Vtiger_Helper_Js.showPnotify({text:app.vtranslate(n.error.message),title:app.vtranslate("JS_LBL_PERMISSION")})}})});d.stopPropagation()})},registerMassRecordsEvents:function(){var a=this;jQuery(".listViewActionsDiv").on("click",".massRecordEvent",function(d){var e=$(this);var c=Vtiger_List_Js.getInstance();var b=c.checkListRecordSelected();if(b!=true){var f={};if(e.data("confirm")){f.message=e.data("confirm");f.title=e.html()}else{f.message=e.html()}Vtiger_Helper_Js.showConfirmationBox(f).then(function(k){var j=jQuery.progressIndicator();var g={viewname:c.getCurrentCvId(),selected_ids:c.readSelectedIds(true),excluded_ids:c.readExcludedIds(true)};var h=Vtiger_List_Js.getInstance();if(h.getListSearchInstance()){var i=h.getListSearchInstance().getAlphabetSearchValue();g.search_params=JSON.stringify(h.getListSearchInstance().getListSearchParams());if((typeof i!="undefined")&&(i.length>0)){g.search_key=h.getListSearchInstance().getAlphabetSearchField();g.search_value=i;g.operator="s"}}AppConnector.request({type:"POST",url:e.data("url"),data:g}).then(function(l){j.progressIndicator({mode:"hide"});if(l&&l.result&&l.result.notify){Vtiger_Helper_Js.showMessage(l.result.notify)}a.getListViewRecords()},function(l,m){j.progressIndicator({mode:"hide"})})})}else{c.noRecordSelectedAlert()}})},registerEmailFieldClickEvent:function(){var a=this.getListViewContentContainer();a.on("click",".emailField",function(b){b.stopPropagation()})},registerPhoneFieldClickEvent:function(){var a=this.getListViewContentContainer();a.on("click",".phoneField",function(b){b.stopPropagation()})},registerUrlFieldClickEvent:function(){var a=this.getListViewContentContainer();a.on("click",".urlField",function(b){b.stopPropagation()})},inactiveFieldsValidation:function(e){var d=jQuery("#massEditFieldsNameList").data("value");for(var g in d){var b=d[g];var c=e.find('[name="'+b.name+'"]');if(b.type=="reference"){c=e.find('[name="'+b.name+'_display"]')}else{if(b.type=="multipicklist"||b.type=="sharedOwner"){c=e.find('[name="'+b.name+'[]"]')}}if(c.length==0){continue}var a=c.data();var f="validate[]";if("validationEngine" in a){f=a.validationEngine;delete a.validationEngine}c.attr("data-invalid-validation-engine",f);c.removeAttr("data-validation-engine")}},registerEventForTabClick:function(b){var a=b.find(".massEditTabs");a.on("click",'a[data-toggle="tab"]',function(d){b.validationEngine("validate");var c=b.data("jqv").InvalidFields;if(c.length>0){d.stopPropagation()}})},registerSlimScrollMassEdit:function(){app.showScrollBar(jQuery('div[name="massEditContent"]'),{height:app.getScreenHeight(70)+"px"})},registerMassActionSubmitEvent:function(){var a=this;jQuery("body").on("submit","#massSave",function(g){var f=jQuery(g.currentTarget);var c=f.find("#commentcontent");var b=c.val();if(b==""){var d=app.vtranslate("JS_LBL_COMMENT_VALUE_CANT_BE_EMPTY");c.validationEngine("showPrompt",d,"error","bottomLeft",true);g.preventDefault();return}c.validationEngine("hide");jQuery(f).find("[name=saveButton]").attr("disabled","disabled");a.massActionSave(f).then(function(e){Vtiger_List_Js.clearList()});g.preventDefault()})},changeCustomFilterElementView:function(){var c=this;var a=this.getFilterSelectElement();if(a.length>0&&a.is("select")){app.showSelect2ElementView(a,{templateSelection:function(e){var d=jQuery("<span></span>");d.append(jQuery(jQuery(".filterImage").clone().get(0)).show());d.append(e.text);return d},customSortOptGroup:true,closeOnSelect:true});var b=a.data("select2");jQuery(".filterActionsDiv").appendTo(b.$dropdown.find(".select2-dropdown:last")).removeClass("hide").on("click",function(d){c.registerCreateFilterClickEvent(d)})}},registerFeaturedElementsEvent:function(){var a=this;var b=this.getListViewTopMenuContainer();b.on("click",".featuredLabel",function(d){var c=jQuery(this).data("cvid");a.getFilterSelectElement().val(c).trigger("change")})},triggerDisplayTypeEvent:function(){var a=app.cacheGet("widthType","narrowWidthType");if(a){var b=jQuery(".listViewEntriesTable").find("td,th");b.attr("class",a)}},registerEventForTotalRecordsCount:function(){var a=this;jQuery(".totalNumberOfRecords").on("click",function(d){var b=jQuery(d.currentTarget);var c=jQuery("#totalCount");var f=c.val();b.addClass("hide");b.parent().progressIndicator({});if(f==""){a.getPageCount().then(function(e){f=e.result["numberOfRecords"];c.val(f);a.showPagingInfo()})}else{a.showPagingInfo()}b.parent().progressIndicator({mode:"hide"})})},showPagingInfo:function(){var c=jQuery("#totalCount").val();var e=jQuery(".pageNumbersText");var d=e.text();var b=d+" ("+c+")";var a=parseInt(jQuery("#noOfEntries").val());if(a!=0){jQuery(".pageNumbersText").html(b)}else{jQuery(".pageNumbersText").html("")}},registerUnreviewedCountEvent:function(){var e=this;var d=[];var a=this.getListViewContentContainer();var c=a.find(".unreviewed").length;a.find("tr.listViewEntries").each(function(){var f=jQuery(this).data("id");if(f){d.push(f)}});if(!d||c<1){return}var b={action:"ChangesReviewedOn",mode:"getUnreviewed",module:"ModTracker",sourceModule:app.getModuleName(),recordsId:d};AppConnector.request(b).then(function(f){var g=f.result;$.each(g,function(i,h){if(h.a>0){a.find('tr[data-id="'+i+'"] .unreviewed .badge.all').text(h.a)}if(h.m>0){a.find('tr[data-id="'+i+'"] .unreviewed .badge.mail').text(h.m)}});Vtiger_Helper_Js.showHorizontalTopScrollBar()})},registerLastRelationsEvent:function(){var e=this;var d=[];var a=this.getListViewContentContainer();var b=a.find(".timeLineIconList").length;a.find("tr.listViewEntries").each(function(){var f=jQuery(this).data("id");if(f){d.push(f)}});if(!d||b<1){return}var c={action:"LastRelation",module:"ModTracker",sourceModule:app.getModuleName(),recordsId:d};AppConnector.request(c).then(function(f){var g=f.result;$.each(g,function(i,h){if(h.type){a.find('tr[data-id="'+i+'"] .timeLineIconList span').addClass(h.color+" userIcon-"+h.type).parent().removeClass("hide").on("click",function(l){var k=jQuery(l.currentTarget);var j=k.data("url");app.showModalWindow(null,j,function(m){Vtiger_Index_Js.registerMailButtons(m)})})}});Vtiger_Helper_Js.showHorizontalTopScrollBar()})},registerChangeEntityStateEvent:function(){var a=this;$(".dropdownEntityState a").click(function(c){var b=$(this);$("#entityState").val(b.data("value"));app.setMainParams("pageNumber","1");app.setMainParams("pageToJump","1");$("#recordsCount").val("");$("#totalPageCount").text("");$(".pagination").data("totalCount",0);$("#dropdownEntityState").find("span").attr("class",b.find("span").attr("class"));a.getListViewRecords().then(function(d){a.calculatePages().then(function(){a.updatePagination()})})})},registerSummationEvent:function(){var a=this;this.getListViewContentContainer().on("click",".listViewSummation button",function(){var d=$(this);var b=d.closest("td").find(".calculateValue");var e=a.getDefaultParams();var c=$.progressIndicator({message:app.vtranslate("JS_CALCULATING_IN_PROGRESS"),position:"html",blockInfo:{enabled:true}});e.action="List";e.mode="calculate";e.fieldName=d.data("field");e.calculateType=d.data("operator");if(a.checkListRecordSelected()!=true){e.selected_ids=a.readSelectedIds(true);e.excluded_ids=a.readExcludedIds(true)}delete e.view;app.hidePopover(d);AppConnector.request(e).then(function(f){if(f.success){b.html(f.result)}else{b.html("")}c.progressIndicator({mode:"hide"})})})},registerEvents:function(){this.breadCrumbsFilter();this.registerRowClickEvent();this.registerPageNavigationEvents();this.registerMainCheckBoxClickEvent();this.registerCheckBoxClickEvent();this.registerSelectAllClickEvent();this.registerDeselectAllClickEvent();this.registerRecordEvents();this.registerMassRecordsEvents();this.registerHeadersClickEvent();this.registerMassActionSubmitEvent();this.changeCustomFilterElementView();this.registerChangeCustomFilterEvent();this.registerChangeEntityStateEvent();this.registerDuplicateFilterClickEvent();this.registerEditFilterClickEvent();this.registerDeleteFilterClickEvent();this.registerApproveFilterClickEvent();this.registerDenyFilterClickEvent();this.registerCustomFilterOptionsHoverEvent();this.registerEmailFieldClickEvent();this.registerPhoneFieldClickEvent();Vtiger_Helper_Js.showHorizontalTopScrollBar();this.registerUrlFieldClickEvent();this.registerEventForTotalRecordsCount();this.registerSummationEvent();var a=this.getListViewContentContainer();a.find("#listViewEntriesMainCheckBox,.listViewEntriesCheckBox").prop("checked",false);this.getListSearchInstance(false);this.registerListViewSpecialOptiopn();this.registerFeaturedElementsEvent();this.registerUnreviewedCountEvent();this.registerLastRelationsEvent();Vtiger_Index_Js.registerMailButtons(a)},registerListViewSpecialOptiopn:function(){var b=this;var c=this.getListViewContentContainer();var a=c.find(".listViewEntriesTable input.searchInSubcategories");a.on("change",function(h){var f=jQuery(h.currentTarget);var d=jQuery('.listSearchContributor[name="'+f.data("columnname")+'"]');var g=d.val();if(g){b.getListSearchInstance().triggerListSearch()}})},postMassDeleteRecords:function(){var a=jQuery.Deferred();var c=Vtiger_List_Js.getInstance();app.hideModalWindow();var b=app.getModuleName();c.getListViewRecords().then(function(d){jQuery("#recordsCount").val("");jQuery("#totalPageCount").text("");jQuery("#deSelectAllMsg").trigger("click");c.calculatePages().then(function(){c.updatePagination()});a.resolve()});jQuery("#recordsCount").val("");return a.promise()},});