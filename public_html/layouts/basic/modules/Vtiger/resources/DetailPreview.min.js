
Vtiger_Detail_Js("Vtiger_DetailPreview_Js",{},{registerLinkEvent:function(a){$("#page").on("click","a",function(c){c.preventDefault();var b=$(this);if(!b.closest("div").hasClass("fieldValue")||b.hasClass("showReferenceTooltip")){if(b.attr("href")&&b.attr("href")!="#"){top.location.href=b.attr("href")}}})},updateWidgetEvent:function(a,b){app.event.on("DetailView.Widget.AfterLoad",function(f,d,g,c){a.height(b.height()-10)})},registerSizeEvent:function(b){var e=this;var d=$(top.document).find("#listPreviewframe");var c=d.contents().find("#listPreviewframe");var a=$(".mainContainer");var f=c.closest(".panel-body");c.contents().find("body").on("DetailView.BlockToggle.PostLoad",function(h,g){if(c.closest(".panel-body").length){c.height(c.contents().find(".mainContainer").height()-10);f.height(c.height()+100);d.height(d.contents().find(".detailViewContainer").height())}});app.event.on("RelatedList.AfterLoad",function(h,g){d.height(d.contents().find(".detailViewContainer").height())});app.event.on("DetailView.BlockToggle.PostLoad",function(j,h,i,g){if(c.length){c.height(a.height()-10);d.height(c.height()+c.offset().top+10)}else{d.height(a.height()-10)}});app.event.on("DetailView.SaveComment.AfterLoad",function(i,j,g,h){if(c.length){c.height(a.height()-10);d.height(c.height()+c.offset().top+10)}else{d.height(a.height()-10)}});e.updateWidgetEvent(d,a);app.event.on("DetailView.Tab.AfterLoad",function(j,h,g){if(d.contents().find("#listPreviewframe").length){var i=d.contents().find("#listPreviewframe");i.height($(".detailViewContainer").height());d.height(i.height()+i.offset().top+10);var k=$("#listPreviewframe");$("#listPreviewframe").load(function(){k.height(k.contents().find(".detailViewContainer").height());d.height(k.height()+k.offset().top+15)});e.updateWidgetEvent(k,a)}else{d.height(a.height()-10);e.updateWidgetEvent(d,a)}})},registerEvents:function(){this._super();this.registerLinkEvent();this.registerSizeEvent()}});