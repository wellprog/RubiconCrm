
jQuery.Class("Settings_Module_Import_Js",{},{getImportModuleStep1Params:function(){var a={module:app.getModuleName(),parent:app.getParentModuleName(),view:"ModuleImport"};return a},getImportModuleStepView:function(c){var a=jQuery.Deferred();var b=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});AppConnector.request(c).then(function(d){b.progressIndicator({mode:"hide"});a.resolve(d)},function(d){b.progressIndicator({mode:"hide"});a.reject(d)});return a.promise()},registerEventForStep1:function(){var a=jQuery(".contentsDiv");app.showScrollBar(jQuery(".extensionDescription"),{height:"120px",width:"100%",railVisible:true});this.registerEventsForImportModuleStep1(a)},registerEventsForImportModuleStep1:function(a){var b=this;jQuery(a).find(".installExtension").on("click",function(h){var f=jQuery(h.currentTarget);var c=f.closest(".extension_container");var j=c.find('[name="extensionId"]').val();var d=c.find('[name="moduleAction"]').val();var g=c.find('[name="extensionName"]').val();var i={module:app.getModuleName(),parent:app.getParentModuleName(),view:"ModuleImport",mode:"step2",extensionId:j,moduleAction:d,extensionName:g};b.getImportModuleStepView(i).then(function(k){var e=jQuery(".contentsDiv");e.html(k);app.showScrollBar(jQuery("#extensionLicense"),{height:"auto"});b.registerEventsForImportModuleStep2(e)})})},registerEventsForImportModuleStep2:function(a){var a=jQuery(a);var b=this;a.find("#installExtension").on("click",function(){var g=jQuery('[name="extensionId"]').val();var d=jQuery('[name="targetModule"]').val();var e=jQuery('[name="moduleType"]').val();var c=jQuery('[name="moduleAction"]').val();var h=jQuery('[name="fileName"]').val();var f={module:app.getModuleName(),parent:app.getParentModuleName(),view:"ModuleImport",mode:"step3",extensionId:g,moduleAction:c,targetModule:d,moduleType:e,fileName:h};b.getImportModuleStepView(f).then(function(i){var j=function(l){var m=jQuery(l).find('[name="installationStatus"]').val();if(m=="success"){jQuery("#installExtension").remove()}app.showScrollBar(jQuery("#installationLog"),{height:"150px"});jQuery(l).find("#importCompleted").on("click",function(n){a.find("#declineExtension").trigger("click")})};var k={data:i,unblockcb:function(){a.find("#declineExtension").trigger("click")},css:{width:"60%",height:"40%"},cb:j};app.showModalWindow(k)})});a.find("#declineExtension").on("click",function(){var c=b.getImportModuleStep1Params();b.getImportModuleStepView(c).then(function(e){var d=jQuery(".contentsDiv");d.html(e);b.registerEventForStep1()})})},registerEvents:function(){this.registerEventForStep1()}});jQuery(document).ready(function(){var a=new Settings_Module_Import_Js();a.registerEvents()});