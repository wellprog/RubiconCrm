
jQuery.Class("Settings_DAV_Js",{},{mobileContainer:false,getContainer:function(){if(this.mobileContainer==false){this.mobileContainer=jQuery("#DavKeysContainer")}return this.mobileContainer},addKey:function(f){var b=jQuery("#DavKeysContainer");var a=b.find(".addKeyContainer");var c=a.clone(true,true);var d=function(e){e.find(".addKeyContainer").removeClass("hide").show();app.showSelect2ElementView(e.find(".select"));e.find('[name="saveButton"]').click(function(k){var i=e.find("form");var j=i.serializeFormData();var g=$.progressIndicator({message:app.vtranslate("Adding a Key"),blockInfo:{enabled:true}});var h=new Settings_DAV_Js();h.registerSaveEvent("addKey",j,true);g.progressIndicator({mode:"hide"})})};app.showModalWindow(c,function(e){if(typeof d=="function"){d(e)}},{width:"1000px"})},deleteKey:function(d){var c=$(d.currentTarget);var a=c.closest("tr");var b=new Settings_DAV_Js();b.registerSaveEvent("deleteKey",{user:a.data("user"),name:a.data("name")});a.remove()},registerSaveEvent:function(d,b,a){var c={};c.data={module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",mode:d,params:b};c.async=false;c.dataType="json";AppConnector.request(c).then(function(f){var e=f.result;var g={text:e.message,animation:"show",};if(e.success==true){g.type="success"}else{g.type="error"}Vtiger_Helper_Js.showPnotify(g);if(a==true&&e.success==true){window.location.reload()}},function(f,e){})},registerEvents:function(c){var b=this;var a=b.getContainer();a.find(".addKey").click(b.addKey);a.find(".deleteKey").click(b.deleteKey)}});jQuery(document).ready(function(){var a=new Settings_DAV_Js();a.registerEvents()});