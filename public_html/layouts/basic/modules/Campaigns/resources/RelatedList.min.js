
Vtiger_RelatedList_Js("Campaigns_RelatedList_Js",{triggerSendEmail:function(){Vtiger_List_Js.triggerSendEmail({relatedLoad:true,sourceModule:app.getModuleName(),sourceRecord:app.getRecordId(),module:jQuery(".relatedModuleName").val(),cvid:jQuery("#recordsFilter").val(),})}},{getCompleteParams:function(){var b=this._super();var a=this.getRelatedContainer();b.selectedIds=a.find("#selectedIds").data("selectedIds");b.excludedIds=a.find("#excludedIds").data("excludedIds");return b},changeCustomFilterElementView:function(){var a=this.content.find("#recordsFilter");if(a.length>0){app.showSelect2ElementView(a,{templateSelection:function(d){var c=jQuery("<span></span>");c.append(jQuery(jQuery(".filterImage").detach().get(0)).show());c.append(d.text);return c},customSortOptGroup:true,closeOnSelect:true});var b=a.data("select2");b.$dropdown.append(this.content.find("span.filterActionsDiv"))}},registerChangeCustomFilterEvent:function(){var d=this;var a=d.getRelatedContainer();var c=a.find(".loadFormFilterButton");var b=a.find("#recordsFilter");c.click(function(g){var f=app.vtranslate("JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_ADD_THIS_FILTER");Vtiger_Helper_Js.showConfirmationBox({message:f}).then(function(){var e=b.val();var j=a.find(".relatedModuleName").val();var i={sourceRecord:app.getRecordId(),relatedModule:j,viewId:e,module:app.getModuleName(),action:"RelationAjax",mode:"addRelationsFromRelatedModuleViewId"};var h=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});AppConnector.request(i).then(function(k){h.progressIndicator({mode:"hide"});if(k!=null){var l=app.vtranslate("JS_NO_RECORDS_RELATED_TO_THIS_FILTER");var m={text:l,type:"info"};Vtiger_Helper_Js.showMessage(m)}else{Vtiger_Detail_Js.reloadRelatedList()}},function(l,k){h.progressIndicator({mode:"hide"})})})})},registerEventToEditRelatedStatus:function(){var c=this;var a=c.getRelatedContainer();a.find(".currentStatus").on("click",function(f){f.stopImmediatePropagation();var d=jQuery(f.currentTarget);d.addClass("open")});var b=a.find(".currentStatus").find(".dropdown-menu");b.on("click","a",function(k){k.stopImmediatePropagation();var h=jQuery(k.currentTarget);var i=h.closest("li");var g=h.closest(".currentStatus");var f=i.attr("id");var d=i.data("status");var j=h.closest("tr").data("id");var l={relatedModule:c.relatedModulename,relatedRecord:j,status:f,module:app.getModuleName(),action:"RelationAjax",sourceRecord:c.parentRecordId,mode:"updateStatus"};h.progressIndicator();AppConnector.request(l).then(function(e){if(e.result[0]){h.progressIndicator({mode:"hide"});g.find(".statusValue").text(d);g.removeClass("open")}},function(m,e){h.progressIndicator({mode:"hide"})})})},registerPostLoadEvents:function(){this._super();this.changeCustomFilterElementView();this.registerChangeCustomFilterEvent();this.registerEventToEditRelatedStatus()}});